<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>KRAS Kickers Volunteer Menu</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
      body {
        background-color: #f8f9fc;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      }
      .hero {
        background-color: #e9f0ff;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 10px 20px;
        margin-bottom: 12px;
        border-radius: 8px;
        gap: 12px;
      }
      .hero img {
        height: 55px;
        margin-right: 8px;
      }
      .hero-text h1 {
        font-weight: 700;
        font-size: 1.6rem;
        margin-bottom: 3px;
      }
      .hero-text p {
        font-size: 0.85rem;
        color: #555;
        margin-bottom: 0;
      }
      .menu-container {
        max-width: 600px;
        margin: 0 auto;
        background: white;
        border: 2px solid #2563eb;
        border-radius: 10px;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        padding: 25px;
      }
      .btn {
        display: block;
        width: 100%;
        margin-bottom: 10px;
        font-size: 1rem;
      }
      .locked {
        pointer-events: none;
        opacity: 0.45;
      }
    </style>
  </head>

  <body class="p-3">
    <div class="container">
      <div class="hero">
        <img src="{{ url_for('static', filename='kras_logo.png') }}" alt="KRAS Kickers Logo">
        <div class="hero-text">
          <h1><span style="color:#000;">KRAS Kickers</span> <span style="color:#2563eb;">VOLUNTEER SYSTEM</span></h1>
          <p>Centralized portal for volunteer management and coordination.</p>
        </div>
      </div>

      <div class="menu-container">

        <!-- ADMIN EMAIL VALIDATION PANEL -->
        <div id="adminLoginPanel" class="mb-3">
          <label for="admin_email" class="form-label fw-semibold">Admin Email (KRAS Kickers Only)</label>
          <input type="email" id="admin_email" class="form-control" placeholder="you@kraskickers.org">

          <button id="adminSendBtn" class="btn btn-primary mt-2">
            Send Verification Email
          </button>

          <div id="adminMessage" class="mt-2 text-center small"></div>
        </div>

        <h4 class="text-center mb-3 text-primary">Select an Option</h4>

        <!-- Buttons wrapped in a section we lock/unlock -->
        <div id="menuOptions">

          <a href="{{ url_for('index') }}" class="btn btn-primary menu-btn">
            1Ô∏è‚É£ Volunteer Application Portal
          </a>

          <a href="{{ url_for('volunteers') }}" class="btn btn-outline-primary menu-btn">
            2Ô∏è‚É£ View Volunteer Applications
          </a>

          <a href="{{ url_for('manage') }}" class="btn btn-outline-primary menu-btn">
            3Ô∏è‚É£ Manage Volunteer Opportunities
          </a>

          <a href="{{ url_for('index') }}" class="btn btn-secondary mt-3 menu-btn">
            üîÅ Refresh Menu
          </a>

        </div>
      </div>
    </div>

    <script>
      // Locking and unlocking functions
      function lockMenu() {
        document.getElementById("menuOptions").classList.add("locked");
      }
      function unlockMenu() {
        document.getElementById("menuOptions").classList.remove("locked");
      }

      const params = new URLSearchParams(window.location.search);

      // If admin_verified=1 is in the URL, unlock the menu
      if (params.get("admin_verified") === "1") {
        unlockMenu();
        document.getElementById("adminLoginPanel").style.display = "none";
      } else {
        lockMenu();
      }

      // SEND ADMIN VERIFICATION REQUEST ‚Äî INSTANT MESSAGE VERSION
      document.getElementById("adminSendBtn").addEventListener("click", function() {
        const email = document.getElementById("admin_email").value.trim().toLowerCase();
        const msgBox = document.getElementById("adminMessage");

        if (!email.endsWith("@kraskickers.org")) {
          msgBox.innerHTML = "<span class='text-danger'>Admin access requires a @kraskickers.org email address.</span>";
          return;
        }

        // Show INSTANT feedback (before server responds)
        msgBox.innerHTML =
          "<span style='color:#2563eb; font-weight:600;'>Sending login link‚Ä¶ check your inbox.</span>";

        // Send request in background
        fetch("/admin_request_access", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ email: email })
        })
        .then(r => r.json())
        .then(resp => {
          if (resp.error) {
            msgBox.innerHTML = "<span class='text-danger'>" + resp.error + "</span>";
          } else {
            msgBox.innerHTML = "<span class='text-success'>" + resp.message + "</span>";
          }
        })
        .catch(err => {
          msgBox.innerHTML = "<span class='text-danger'>Error sending request.</span>";
        });
      });
    </script>
    <!-- Deluxe Professional Footer -->
<footer style="
    margin-top: 40px;
    background: linear-gradient(135deg, #f7f9fc 0%, #eef2f8 100%);
    border-top: 1px solid #d9e2ef;
    padding: 35px 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
">
  <div style="max-width: 1200px; margin: 0 auto; text-align: center;">

    <!-- Powered by text only -->
    <div style="
        font-size: 1.1rem;
        font-weight: 700;
        color: #111827;
        margin-bottom: 8px;
    ">
      Powered by
      <span style="color: #059669;">Hubs.Design</span>
    </div>

    <!-- Subtext -->
    <div style="
        margin-top: 6px;
        font-size: 0.82rem;
        color: #4b5563;
    ">
      Crafting thoughtful digital experiences for organizations making a difference.
    </div>

    <!-- Divider -->
    <div style="
        margin: 20px auto 12px;
        width: 80px;
        height: 1px;
        background-color: #cbd5e1;
    "></div>

    <!-- Copyright -->
    <div style="
        font-size: 0.78rem;
        color: #6b7280;
    ">
      ¬© <script>document.write(new Date().getFullYear())</script> Hubs.Design. All rights reserved.
    </div>

  </div>
</footer>

  </body>
</html>
